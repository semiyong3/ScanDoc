# ScanDoc 프로그램 사용법

## 1. 프로그램 사용법 (중요!)

### 1-1. Scan Directory
(이전과 동일)

### 1-2. Convert To Image (DRM 캡처 방식)
이 기능은 `Alt+PrintScreen` (활성 창 캡처)을 이용한 수동 캡처 방식입니다.

1.  **수동으로** 변환할 DRM 문서(PPT, Word, PDF 뷰어 등)를 엽니다.
2.  ScanDoc 프로그램에서 `Target File`을 선택합니다. (출력될 `zip` 파일의 이름을 정하는 데 사용됩니다.)
3.  `Output Dir`에 `zip` 파일이 저장될 폴더를 지정합니다.
4.  [RUN] 버튼을 누르고, 안내 팝업창에서 [확인]을 누릅니다.
5.  **"Capture Session"**이라는 작은 보조창이 뜹니다.
6.  1번에서 열어둔 **문서 창을 마우스로 클릭**하여 활성화시킵니다.
7.  키보드의 **F9** 키를 누릅니다. (또는 보조창의 "Capture" 버튼 클릭)
    * (이때 프로그램이 내부적으로 `Alt+PrintScreen` 키를 눌러 클립보드에 복사 후 저장합니다.)
8.  캡처가 완료되면 수동으로 문서의 다음 페이지로 이동합니다.
9.  다시 **F9** 키를 눌러 다음 페이지를 캡처합니다.
10. 마지막 페이지까지 캡처를 반복합니다.
11. 모든 캡처가 끝나면, "Capture Session" 보조창의 **[Finish & Zip]** 버튼을 누릅니다.
12. `Output Dir`에 `파일명.zip` 파일이 생성됩니다.

### 1-3. Convert To PDF
(이전과 동일)

## 2. 프로그램 실행 (Python 스크립트로 실행 시)

1.  PC에 Python 3.8 이상을 설치합니다.
2.  프로젝트 폴더에서 다음 명령어를 실행하여 라이브러리를 설치합니다.
    ```bash
    pip install -r requirements.txt
    ```
3.  다음 명령어로 프로그램을 실행합니다.
    ```bash
    python main.py
    ```

## 3. 프로그램 실행 (.exe 빌드 및 실행)

1.  `build.bat` 파일을 실행합니다.
2.  빌드가 완료되면 `dist` 폴더 안에 `ScanDoc.exe` 파일이 생성됩니다.
3.  `ScanDoc.exe` 파일을 실행합니다.



## DRM 이 걸린 엑셀을 이미지로 변한하는 것이 불가능한 이유
DRM이 걸려있는 엑셀 파일의 **'전체 범위'**를 **'하나의 이미지'**로 완벽하게 자동 캡처하는 것은, 안타깝게도 워드나 PPT와 달리 사실상 불가능합니다.

그 이유는 엑셀 프로그램의 구조와 DRM의 차단 방식 때문입니다.

🧐 엑셀이 워드/PPT와 다른 이유
워드/PPT (페이지 기반): GoTo(Page=3) 또는 Slide(3).Select()처럼 명확한 "페이지" 단위로 이동할 수 있습니다. 우리는 이 기능을 이용해 페이지를 넘기고, 창 전체를 캡처(capture_active_window(hwnd))할 수 있었습니다.

엑셀 (그리드 기반): 엑셀은 "페이지" 개념이 없습니다. 데이터가 A1부터 Z50000까지 이어지는 거대한 그리드(Grid)입니다. 사용자가 원하는 "값이 있는 전체"를 보려면 스크롤이 필요합니다.

🚫 자동화가 불가능한 이유 (DRM 차단)
DRM 없이 "전체 범위"를 "하나의 이미지"로 만드는 유일한 방법은 엑셀의 내장 기능인 Range.CopyPicture를 사용하는 것입니다. 하지만 이 방법은 DRM 때문에 실패합니다.

우리가 시도할 수 있는 모든 자동화 방법과 그 실패 원인은 다음과 같습니다.

1. (실패) 엑셀 내장 기능 Range.CopyPicture 사용
방법: sheet.UsedRange.CopyPicture() (전체 범위를 하나의 이미지로 클립보드에 복사)

원인 (DRM): MarkAny DRM은 CopyPicture 같은 내부 복사 명령이나 클립보드 접근 자체를 "정보 유출"로 간주하고 차단합니다. ImageGrab.grabclipboard()는 None을 반환할 것입니다.

2. (실패) 수동으로 셀을 지정한 후 **[그림으로 복사]**를 선택하고 이를 그림판에 붙여넣기

